▶️ [Streamlit 대시보드 바로가기](https://godfuf-ls-elec.streamlit.app/)

# ⚡ 전력사용에 따른 전기요금 예측 및 모니터링 대시보드

---

## 📌 프로젝트 개요

본 프로젝트는 **전력 사용 데이터를 활용하여**,

* 머신러닝/딥러닝 기반 전기요금 예측 모델링
* 실시간 전기요금 모니터링 및 SHAP 기반 영향요인 분석
* 과거 전력 사용 패턴 분석 및 자동 보고서 생성
  기능을 통합한 **종합 에너지 관리 시스템**입니다.

예상 사용자는 **에너지 관리팀, 시설 관리자 및 경영진**으로, 에너지 효율성 향상 및 전기요금 절약이라는 목적을 달성할 수 있습니다.

---

## 🚀 주요 기능

| 기능 영역 | 설명 |
| ----------- | ------------------------------------- |
| 🤖 AI 예측 모델 | 머신러닝 및 딥러닝 모델 개발/비교/선정 |
| ⚡ 실시간 모니터링 | 저장된 모델 활용한 실시간 추적 및 SHAP 기반 영향요인 분석 |
| 📊 과거 분석 | 월별/일별 전력 사용 패턴 분석 및 시각화 |
| 📋 자동 보고서 | Word 형태 전력 분석 보고서 자동 생성 |

---

## 🧰 기술 스택

| 분야 | 사용 기술 |
| ----- | ------------------------------------------------------------ |
| 언어 | Python |
| 프레임워크 | [Streamlit](https://streamlit.io/), TensorFlow/Keras |
| 시각화 | Plotly, Matplotlib, Seaborn |
| 머신러닝 | Scikit-learn, XGBoost, LightGBM, CatBoost |
| 딥러닝 | LSTM, GRU |
| 해석가능 AI | SHAP |
| 문서 생성 | python-docx |
| 배포 | Streamlit Cloud |

---

## 📈 데이터 설명

### 🗂️ 데이터 출처
**Kaggle 전력 요금 예측 경진대회**: https://www.kaggle.com/competitions/ls-electricity/

### 📊 학습 데이터 (train.csv)
**📅 기간**: 2024년 1월 ~ 11월

| 컬럼명 | 설명 |
| ------ | ---- |
| id | 각 측정값의 고유 식별자 |
| 측정일시 | 측정이 이루어진 날짜와 시간 (15분 간격) |
| 전력사용량(kWh) | 실제 전력 사용량 (예측 기초가 되는 입력 변수) |
| 지상무효전력량(kVarh) | 무효 전력량 (지상 역률에서 발생) |
| 진상무효전력량(kVarh) | 무효 전력량 (진상 역률에서 발생) |
| 탄소배출량(tCO2) | 전력 사용으로 인한 탄소 배출량 |
| 지상역률(%) | 지상 방향의 역률(%) |
| 진상역률(%) | 진상 방향의 역률(%) |
| 작업유형 | 해당 시점의 부하 유형 (예: Light_Load 등) |
| **전기요금(원)** | **예측 대상 값으로, 전력사용량 등을 기반한 계산된 실제 전기요금** |

### 🎯 예측 데이터 (test.csv)
**📅 기간**: 2024년 12월

| 컬럼명 | 설명 |
| ------ | ---- |
| id | 테스트 샘플 고유 식별자 |
| 측정일시 | 예측 대상 시점의 날짜 및 시간 |
| 부하유형 | 해당 시점의 예상 부하 유형 (카테고리컬 변수) |

---

## 🔧 데이터 전처리 및 피처 엔지니어링

### 📍 기본 전처리
* **결측치 처리**: Lag 및 Rolling 피처 생성 시 결측값을 0으로 대체
* **이상치 제거**: 특정 시점(2024-11-07 00:00:00) 데이터 필터링
* **시간 정규화**: 측정일시를 기준으로 시간 관련 피처 생성

### 📍 고급 피처 생성
* **시간 피처**: 
  - 순환 인코딩 (hour_sin, hour_cos, month_sin, month_cos)
  - 공휴일/주말 여부, 계절성 피처
  - 피크시간 및 시간대별 카테고리 인코딩

* **전력 조합 피처**:
  - 총 전력량 (total_power = 유효전력 + 무효전력들)
  - 유효전력 비율 (active_power_ratio)
  - 전력 효율성 지수 (power_efficiency)
  - 전력 품질 지수 (power_quality)

* **시계열 피처**:
  - Lag 피처 (2, 3, 6, 12, 24시간)
  - Rolling 통계량 (평균, 표준편차, 최대/최소값)
  - 비선형 변환 (log, square, sqrt)

* **역률 최적화**:
  - 한전 요금체계 기준 역률 이진화
  - 진상역률_이진 (90% 기준), 지상역률_이진 (65% 기준)

### 📍 피처 선택
* **다중 중요도 분석**: RandomForest, XGBoost, 순열 중요도, SHAP 분석
* **합의 점수 기반**: 상위 45개 핵심 피처 선별
* **시계열 특성 고려**: 48시간 시퀀스 + 정적 피처 조합

---

## 🏆 최종 모델

### 📍 LSTM 딥러닝 모델 (최종 채택)

* **모델 구조**: 시계열 데이터에 최적화된 LSTM 아키텍처
* **입력 데이터**: 48시간 시퀀스 + 정적 피처 조합
* **학습 방식**: 5-fold 시계열 교차검증
* **선정 기준**: **검증 MAE 값이 가장 낮은 모델을 Kaggle에 제출**하여 최고 성능 달성
* **특징**: 전력 사용 패턴의 장기 의존성을 효과적으로 학습

### 📍 모델 비교 결과

Kaggle 경진대회 제출 결과를 바탕으로 **LSTM 모델이 최고 성능**을 보여 최종 채택:

* **기존 ML 모델들**: RandomForest, XGBoost, LightGBM, CatBoost
* **딥러닝 모델들**: LSTM, GRU, Transformer 
* **앙상블 기법**: 스태킹, 가중 평균 등 다양한 조합 시도
* **최종 결정**: **로컬 검증에서 가장 낮은 MAE를 기록한 LSTM 모델을 제출**하여 Kaggle Public/Private 리더보드에서 최고 점수 기록

### 📍 최종 모델 활용

* **모델 저장**: 최종 선정된 LSTM 모델을 **pickle 파일로 저장**
* **대시보드 활용**: 실시간 모니터링 대시보드에서 **저장된 피클 모델을 로드**하여 SHAP 분석 및 예측에 활용
* **실시간 예측**: 피클 파일을 불러와 스트리밍 데이터에 대한 실시간 전기요금 예측 수행

---

## 📊 시스템 구성

### ① 모델 개발 (model_final.py)

* 기존 ML 모델 4개 (RandomForest, XGBoost, LightGBM, CatBoost)
* 딥러닝 모델 4개 (LSTM, GRU 각각 평균/최소값 방식)
* 5-fold 시계열 교차검증을 통한 모델 비교
* 최종 LSTM 모델을 피클 파일로 저장

### ② 실시간 모니터링 대시보드 (실시간 전기요금 모니터링.py)

* 저장된 피클 모델을 활용한 실시간 전력 사용량 및 전기요금 스트리밍
* SHAP 기반 실시간/누적 영향요인 분석
* KPI 대시보드 (누적 사용량, 요금, 탄소배출량 등)
* 페이징 기반 상세 데이터 테이블

### ③ 과거 분석 대시보드 (과거 전기요금 분석 보고서.py)

* 월별/일별 전력 사용 패턴 분석
* 시간대별 부하 분포 및 작업유형별 분석
* 역률 기반 한전 요금 영향 분석
* 자동 Word 보고서 생성 (차트 포함)

---

## 🔍 성능 평가 및 해석

* **SHAP 분석**: 실시간 변수별 기여도 분석
* **피처 중요도**: 순열 중요도, 상관관계, 합의 점수 기반
* **시각적 해석**: 시간대별 패턴, 작업유형별 분석
* **비즈니스 가치**: 역률 개선을 통한 요금 절약 효과 정량화

---

## 프로젝트 구성원
* 홍주형, 김보경, 김예원, 남원정, 박한슬, 양현준, 편서영
